# Graph-R1: Towards Agentic GraphRAG Framework via End-to-End Reinforcement Learning

## **🧠 一、研究背景：为什么提出 Graph-R1？**

大模型（LLM）在知识密集型任务中容易“幻觉”（hallucination），即生成虚假内容。为了缓解这个问题，**检索增强生成（RAG）** 被提出，通过引入外部知识提升回答的准确性。

但传统 RAG 方法存在以下问题：

| **问题** | **描述** |
| --- | --- |
| ❌ 缺乏结构语义 | 基于文本块（chunk）检索，难以建模实体间复杂关系 |
| ❌ 一次性检索 | 只检索一次，无法根据中间推理动态调整 |
| ❌ 强依赖 LLM 能力 | 需要大模型具备长文本理解与推理能力，效果不稳定 |

GraphRAG 尝试用图结构表示知识，但仍存在：

- 建图成本高
- 检索过程固定
- 对 LLM 的长文本推理依赖大

---

## **🌟 二、Graph-R1 的核心贡献**

Graph-R1 提出了一个**智能体驱动的 GraphRAG 框架**，通过**端到端强化学习（RL）**优化整个检索与生成流程，具体有三项创新：

| **模块** | **创新点** | **说明** |
| --- | --- | --- |
| 1. 知识构建 | 轻量级超图构建 | 用 LLM 提取 n 元关系，构建超图（hypergraph），保留高阶语义 |
| 2. 检索机制 | 多轮智能体交互 | 将检索建模为“思考-检索-再思考-生成”的多轮交互过程 |
| 3. 优化目标 | 端到端强化学习 | 用 GRPO 算法统一优化生成质量、检索相关性和图路径结构可靠性 |

---

## **🧪 三、方法详解**

### **1. 知识超图构建（Knowledge HyperGraph Construction）**

- 输入：文档集合
- 输出：超图 *GH*=(*V*,*EH*,*ϕ*)
- 每个超边（hyperedge）表示一个 n 元关系（如：A 是 B 的导演，C 是 A 的配偶）
- 使用共享编码器 *ϕ* 对实体和关系进行语义编码

### **2. 多轮智能体交互（Agentic Multi-Turn Interaction）**

智能体在每一步执行以下动作：

| **动作** | **说明** |
| --- | --- |
| Think | 判断当前知识是否足够，是否继续检索 |
| Query | 生成新的检索查询 |
| Retrieve | 从超图中检索相关知识（实体+超边） |
| Answer | 若知识足够，生成最终答案 |

这个过程重复多轮，直到智能体决定“回答”为止。

### **3. 强化学习优化（End-to-End RL with GRPO）**

- 使用 GRPO（Group Relative Policy Optimization）训练策略
- 奖励函数包括：
    - **格式奖励**：是否遵循“思考-检索-回答”结构
    - **答案奖励**：生成答案与真实答案的 F1 相似度
- 目标：最大化整个推理轨迹的答案质量与结构一致性

---

## **📊 四、实验结果**

### **数据集（6 个标准 RAG 基准）**

| **数据集** | **类型** | **说明** |
| --- | --- | --- |
| 2WikiMultiHopQA | 多跳问答 | 需跨文档推理 |
| HotpotQA | 多跳问答 | 含支持句标注 |
| Musique | 多跳问答 | 推理链更长 |
| Natural Questions | 单跳问答 | Google 搜索问题 |
| PopQA | 开放域 | 流行文化问题 |
| TriviaQA | 开放域 | 常识问答 |

### **对比方法（部分）**

| **方法** | **特点** |
| --- | --- |
| StandardRAG | 文本块检索 |
| GraphRAG | 图结构检索 |
| HyperGraphRAG | 超图结构检索 |
| Search-R1 | RL+文本块检索 |
| R1-Searcher | RL+两阶段检索 |

### **实验结果（Qwen2.5-7B 模型）**

| **方法** | **平均 F1** |
| --- | --- |
| StandardRAG | 32.05 |
| HyperGraphRAG | 29.40 |
| Search-R1 | 46.19 |
| **Graph-R1（本文）** | **57.82** ✅ |

---

## **✅ 五、总结与意义**

| **优势** | **说明** |
| --- | --- |
| ✅ 更高的准确性 | 在 6 个数据集上全面超越现有方法 |
| ✅ 更低的成本 | 建图成本低于 GraphRAG 和 HyperGraphRAG |
| ✅ 更强的泛化能力 | 在分布外（OOD）数据上表现更稳定 |
| ✅ 可扩展性 | 支持不同大小模型（1.5B → 7B） |

---

## **🔍 六、开源代码地址**

GitHub 项目地址（含代码、数据、训练脚本）：

👉 [https://github.com/LHRLAB/Graph-R1](https://github.com/LHRLAB/Graph-R1)